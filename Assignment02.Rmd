---
title: "Assignment02"
author: "Megan Willis-Jackson"
date: "2/3/2022"
output: html_document
---

```{r libraries, echo=F, message=F, warning=F}
library(tidyverse)
library(tidycensus)
library(ggplot2)
library(sf)
library(units)
library(tigris)


```

# Load Variables

```{r}
sanjose_msa <- core_based_statistical_areas() %>%
  filter(GEOID == "41940")

view(load_variables(2019, "acs5"))

vars <- c(med_income = "B06011_001") #discuss which variables are needed for analysis

census <- get_acs(geography = "tract",
                  state = "CA",
                  variables = vars,
                  output = "wide",
                  geometry = T) %>%
  st_filter(sanjose_msa)

ggplot(census) +
  geom_sf(aes(fill = med_incomeE), color = alpha("white", .1)) +
  theme_void()

#download employment data
#NOTE: I think we also will need the LEHD residence area characteristics,
#to determine which RESIDENTS will no longer have to commute, in addition to 
#which jobs in the MSA will no longer have commuters.

#creates new variables, including a WFH variable which
#assumes that the job is able to be at least partially remote.
lehd_blocks <- read_csv("https://lehd.ces.census.gov/data/lodes/LODES7/ca/wac/ca_wac_S000_JT00_2019.csv.gz", show_col_types = F) %>%
  rename(total_jobs = C000) %>%
  mutate(basic_jobs = CNS01+CNS02+CNS03+CNS04+CNS05+CNS06+CNS08+CNS09) %>%
  rename(retail_jobs = CNS07) %>%
  mutate(service_jobs = total_jobs - basic_jobs - retail_jobs,
         WFH_jobs = CNS09+CNS10+CNS12+CNS13+CNS19+CNS20) %>%
  select(w_geocode, total_jobs, basic_jobs, retail_jobs, service_jobs)


```
